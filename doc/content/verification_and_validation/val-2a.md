# val-2a

# Ion Beam Experiment

## Case Description

This validation problem is taken from [!cite](anderl1985tritium). This paper describes an ion implantation experiment on a modified 316 stainless steel called Primary Candidate Alloy (PCA). This case is part of the validation suite of TMAP4 and TMAP7 as val-2a [!citep](longhurst1992verification,ambrosek2008verification). The PCA sample is a 0.5 mm thick disk with a diameter of 2.5 cm. It is exposed to a deuterium ion beam on the left side (also called the upstream side of the sample). The TRIM code [!citep](biersack1982stopping) was used in [!cite](longhurst1992verification,ambrosek2008verification) to determine that the average implantation depth for the ions is 11 nm $\pm$ 5.4 nm. Reemission data from the TRIM calculation shows that only 75 % of the incident flux remained in the metal and other 25 % is re-emitted.

This model considers the diffusion in PCA and the recombination of deuterium on the two sides. First, the diffusion of deuterium in PCA is described as:

\begin{equation} \label{eq:diffusion}
\frac{d C}{d t} = D \frac{d^2 C}{d x^2} + S,
\end{equation}

where $C$ is the concentration of deuterium in PCA, $t$ is the time, $x$ is the distance from the upstream side, $D$ is the diffusivity of deuterium in PCA, and $S$ is the source term in PCA due to the deuterium ion beam.

Second, the deuterium become gas on the two sides of PCA during recommendation process, which is described as:

\begin{equation} \label{eq:recommendation}
J = A (K_r C^2 - K_d P^2),
\end{equation}

where $J$ is the recommendation flux out of the upstream or downstream side, $A$ is the area on the upstream or downstream side, $P$ is the pressure on corresponding side, and $K_r$ and $K_d$ are the recommendation coefficient and dissociation coefficient, respectively.

The objective of the model is to determine the permeate flux on the downstream side and match the experimental data published in [!cite](anderl1985tritium) and reproduced in [val-2a_comparison].

## Model Description

In this case, TMAP8 simulates a one-dimensional domain to represent the deuterium diffusion. The deuterium is generated by ion beam and leave from upstream and downstream side by recommendation. Note that this case can easily be extended to a two- or three-dimensional case.

The source term in the model is described as a normal distribution instead of a piecewise function from TMAP4. The source term of deuterium versus the coordinate is defined as:

\begin{equation} \label{eq:normal_distribution}
S = \frac{1.5}{\sigma \sqrt(2 \pi) \exp \left( -0.5 * ((x - \mu ) / \sigma)^2 \right)},
\end{equation}

where $\sigma$ is the characteristic width of the normal distribution, and $\mu$ is the depth of the normal distribution from the upstream side. The comparison between the normal distribution from TMAP8 and piecewise function from TMAP4 is shown in [val-2a_normal_distribution]. The normal distribution has the similar distribution with the piecewise function, and also provide a smooth distribution, which is close to the real situation.

!media figures/val-2a_normal_distribution.png
       style=width:50%;margin-bottom:2%;margin-left:auto;margin-right:auto
       id=val-2a_normal_distribution
       caption= Comparison between the normal distribution from TMAP8 and piecewise function from TMAP4. The area of both functions are normalized as 1.

The pressures on the upstream and downstream sides are close to the vacuum situation, and have less impact for the recommendation on two sides. Thus, TMAP8 ignore the impact of pressure on the boundary conditions to simplify the model. The recommendation is described as:

\begin{equation} \label{eq:recommendation_ignore_Pressure}
J = A K_r C^2.
\end{equation}

## Case and Model Parameters

The beam flux on the upstream side of the sample during the experiment are presented in [val-2a_flux_and_pressure_TMAP4]. Other case and model parameters in TMAP8 are listed in [val-2a_set_up_values_TMAP4]. Some of the parameters are directly leveraged from [!cite](anderl1985tritium,longhurst1992verification,ambrosek2008verification), but others were adapted to better match the experimental data.

!table id=val-2a_flux_and_pressure_TMAP4 caption=Values of beam flux on the upstream side of the sample during the experiment [!citep](longhurst1992verification).
| time (s)      | Beam flux (atom/m$^2$/s)     |
| ---------     | ---------------------------- |
| 0 - 5820      | 4.9$\times 10^{19}$          |
| 5820 - 9056   | 0                            |
| 9056 - 12062  | 4.9$\times 10^{19}$          |
| 12062 - 14572 | 0                            |
| 14572 - 17678 | 4.9$\times 10^{19}$          |
| 17678 - 20000 | 0                            |

!alert warning title=Typo in [!cite](longhurst1992verification)
The times of starting and stopping the beam from TMAP4 in [!cite](longhurst1992verification) are not accurate, TMAP8 uses the times from [!cite](anderl1985tritium) directly to get better fit on results.

!table id=val-2a_set_up_values_TMAP4 caption=Values of material properties.
| Parameter | Description                          | Value                                                       | Units                 |
| --------- | ------------------------------------ | ----------------------------------------------------------- | --------------------- |
| $K_{d,l}$ | dissociation coefficient upstream       | 8.959 $\times 10^{18} (1-0.9999 \exp(-6 \times 10^{-5} t))$ | at/m$^2$/s/Pa$^{0.5}$ |
| $K_{d,r}$ | dissociation coefficient on downstream  | 1.7918$\times 10^{15}$                                      | at/m$^2$/s/Pa$^{0.5}$ |
| $K_{r,l}$ | recombination coefficient on upstream   | 1$\times 10^{-27} (1-0.9999 \exp(-6 \times 10^{-5} t))$     | m$^4$/at/s            |
| $K_{r,r}$ | recombination coefficient on downstream | 2$\times 10^{-31}$                                          | m$^4$/at/s            |
| $P_{l}$   | pressure on downstream               | 0                                                           | Pa                    |
| $P_{r}$   | pressure on downstream               | 0                                                           | Pa                    |
| $D$       | deuterium diffusivity in PCA         | 3$\times 10^{-10}$                                          | m$^2$/2               |
| $d$       | diameter of PCA                      | 0.025                                                       | m                     |
| $l$       | thickness of PCA                     | 5$\times 10^{-4}$                                           | m                     |
| $T$       | temperature                          | 703                                                         | K                     |


!alert note title=This validation case replicate TMAP4 rather than TMAP7 due to inconsistent experiment results with [!cite](anderl1985tritium).
TMAP4 [!citep](longhurst1992verification) and TMAP7 [!citep](ambrosek2008verification) both replicate this validation case. However, they use different model parameters and configurations, and the experimental data presented in the experimental data in [!citep](ambrosek2008verification) for TMAP7 do not correspond to the data published in [!cite](anderl1985tritium). We therefore replicate only the data from TMAP4 in this TMAP8 validation case.

!alert note title=The recombination and dissociation coefficient on upstream are simple exponential.
Both TMAP4 [!citep](longhurst1992verification) and TMAP7 [!citep](ambrosek2008verification) simplify the recombination and dissociation coefficients on upstream as exponential in time rather than an integrated ion influence in experiment. Thus, TMAP8 uses the same exponential on recombination and dissociation coefficients.

## Results

[val-2a_comparison] shows the comparison of the TMAP8 calculation and the experimental data from [!cite](anderl1985tritium). There is reasonable agreement between the TMAP predictions and the experimental data with a root mean square percentage error of RMSPE = 26.10 %. Note that the agreement could be improved by adjusting the model parameters. It is also possible to perform this optimization with [MOOSE's stochastic tools module](https://mooseframework.inl.gov/modules/stochastic_tools/index.html).

!media comparison_val-2a.py
       image_name=val-2a_comparison.png
       style=width:50%;margin-bottom:2%;margin-left:auto;margin-right:auto
       id=val-2a_comparison
       caption=Comparison of TMAP8 calculation with the experimental data on the downstream side of the sample. TMAP8 accurately replicate the experimental data.

## Input files

!style halign=left
The input file for this case can be generated by [/val-2a.i]. The file are also used as test in TMAP8 at [/val-2a/tests].

!bibtex bibliography
